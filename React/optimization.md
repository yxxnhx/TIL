# 최적화
## Code Splitting
`Code Splitting`이 무엇일까?
말 그대로 코드를 분할하는 것이다. 즉, 전체 코드를 작은 조각들로 나누는 것이다.
`Code Splitting`을 하면 처음에 불러올 코드가 줄어드니 사용자가 빈 화면을 보는 시간이 줄어든다.

### 특징
#### 지연 로딩(Lazy Loading)
- 애플리케이션의 특정 부분이 사용자에 의해 필요할 때 load하는 것
- 어떤 페이지나 컴포넌트가 사용자의 특정 액션을 통해 나타난다면, 그 액션이 발생하기 전까지는 그 페이지나 컴포넌트를 로드하지 않음

#### 캐싱 최적화
- 코드를 작은 단위로 나누면, 변경이 필요한 부분만 업데이트 가능함
- 전체 애플리케이션을 새로고침하지 않고도, 특정 부분만 쉽게 업데이트할 수 있음

### 최적화 주의사항
- 꼭 필요한 것인지 확인해야 한다. 
불필요한 최적화는 오히려 시간 낭비가 될 수 있기 때문이다.
- Lighthouse 점수에 너무 연연해하지 말자.
점수는 올라갔는데, 화면은 오히려 느린 경우도 있다.

### 이미지 최적화
용량이 너무 크면 로딩도 오래 걸리고 브라우저에 과부하 걸린다.
물론 체감되는 정도는 아닌데, 최적화 관점에서 볼때는 안좋다.

**만약에 화면에 이미지가 10000개 보이는데 모두 오버사이즈라면 어떻게 해야할까?**
권장하는 크기는 2x이나 윈도우는 굳이 2x 필요 없다.
그러나 맥에서 retina display에서 이미지가 깔끔하게 보이려면 2x를 넣어줘야 한다.

**그렇다면 크기는 어떻게 줄여야 할까?**
디자이너가 있다면 이미지를 새로 받는 것이 제일 좋다.
서버에서 스토리지에 이미지를 저장할 때 화면 보고 크기에 맞는 사이즈로 저장해서 사용한다.
확장자는 `.webp`로 사용하는 것이 좋다.

이미지 최적화 제대로 하려면
스토리지에 화면에서 필요한 사이즈별로 이미지를 들고 있어야 한다.
만약 같은 이미지가 여러 화면에 사용되면 해당 영역에 맞는 크기의 presigned-url을 넘겨줘야 한다.

#### 이미지 최적화 - 파일포맷
상황에 따라 다른 포맷을 사용해야함.
- svg : 아이콘 혹은 작은 이미지
 <br /> -> 개인적으로는 64*64보다 작으면 svg이 좋다. 그러나 임의의 기준일 뿐 꼭 따를 필요는 없다
- png : 스크린샷 처럼 세부사항이 잘 보여야 하는 경우
- webp : 요즘 구글에서 미는 파일 포멧이다. 확실히 용량 측면에서 유리하다보니 로드가 빨리 된다.

**jpeg과 png의 차이점**
<br /> 
jpeg은 용량이 작은 대신 품질이 손상되는 경우가 있다.
추가로 가끔 백엔드에서 비용타령하는 경우가 있는데 스토리지 비용 계산해보면 실제로 별로 차이 안난다고 한다.

### 폰트 최적화
- 브라우저 호환성 고려해서 woff, woff2 설정해야 한다.
  그러나 요즘은 왠만하면 다들 브라우저를 크롬 혹은 엣지를 사용하기 때문에 woff2만 설정해도 충분하다는 의견이 있다.

- 가급적이면 웹폰트 사용을 추천한다.
  CDN을 직접 관리 안하는 것 자체만으로도 일단은 관리 포인트가 줄어든다는 큰 장점이 있다. 만약 웹폰트 호스팅을 도저히 못믿겠으면 직접 하는 것도 하나의 방법일 수 있다.
  
- @fontsource 라이브러리 사용하기
  > https://www.npmjs.com/package/@fontsource/noto-sans-kr
<br /> 원하는 폰트를 찾아서 사용할 수 있다. 용량이 훨씬 가볍고 import하면 사용되는 스타일의 폰트만 추가 가능하다는 장점이 있다.

추가적으로 Next.js에서 추천하는 폰트 최적화 방식이 있으나 성능상 우위에 있는지 Lighthouse에서 측정은 안된다.

## 추상화
복잡한 내용을 단순화하는 과정이다. 복잡한 코드의 세부 사항을 걱정하지 않고도 프로그램의 핵심적인 부분에
집중할 수 있게 해준다. 추상화의 목적은 코드의 복잡성을 관리하고 재사용성을 높이는 것이다.
객체지향에 따라 원칙상 재사용성도 고려해야 한다.
주로 프론트에서 컴포넌트를 쪼갤때는 코드 복잡성 관리 + 가독성 향상을 주 목적으로 한다.

**그렇다면 추상화를 어떻게 해야할까?**
- 컴포넌트를 잘 분리한다.
<br /> 변수명만 보고도 그 컴포넌트의 역할을 알 수 있도록 명시적으로 쪼갠다.
컴포넌트 하나의 return구간이 너무 길어지면 로직도 많아지고 jsx도 많아져서 가독성이 떨어지니 주의해야 한다.


추가적으로 해야할 것이 있다면 다음과 같다.
- 불필요한 요청 제거
- 함수형 프로그래밍 원칙
- 불필요한 state 제거
